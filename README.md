# e portfolio export助手 v1.2

> 醫事放射 UGY 實習評量表 HTML 批次分析與匯出工具

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Version](https://img.shields.io/badge/version-1.2-green.svg)

## 📋 功能特色

### 核心功能
- **批次匯入** - 拖放多個 HTML 評量表檔案，自動解析
- **智慧分類** - 自動識別評量類型（總評量表、學員回饋單、單站評量、EPA、基礎課程）
- **科別判定** - 根據表單編號自動歸類至影像醫學科、核子醫學科、放射治療科、心導管室
- **儀器別自動偵測** - 智慧識別 X-ray, CT, MRI, 核醫, 放射治療等各科儀器別 (New!)
- **學員/教師識別** - 通用模式自動提取學員與負責教師姓名
- **現代化架構** - 採用模組化設計 (HTML/CSS/JS 分離)，易於維護與擴充

### v1.2 更新 (2026-02-13)
- ✅ **Milestone 儀器別修正** - 修復 Milestone 類型因全文搜尋誤判儀器別為「放射治療」的問題，改為僅依據「階段/子階段」欄位判定
- ✅ **Milestone CSV 精簡** - CSV 輸出僅保留 12 項指標短標題與 Level 分數，不再包含冗餘描述文字
- ✅ **Milestone 卡片顯示** - 卡片頁面新增 Milestone 各項等級成績展示

### v1.1 更新 (2026-02-12)
- ✅ **儀器別偵測強化** - 新修復核子醫學科（核醫藥物、治療、放射免疫、體內分析）與放射治療科（技術、品保）之儀器別顯示問題
- ✅ **匯出檔名更正** - CSV 匯出預設檔名更新為 `v1.1`

### v1.0 重構更新 (2026-02-09)
- ✅ **模組化架構** - 將原本單一 HTML 拆分為 `index.html`, `style.css`, `parser.js`, `app.js`
- ✅ **代碼優化** - 邏輯與視圖分離，提升效能與可讀性
- ✅ **完整功能保留** - 繼承 v5.4 所有解析邏輯與功能
- ✅ **EPA OPA 分數解析** - 正確提取 OPA1-3 分數
- ✅ **基礎課程統計** - 自動解析通過項目數

## 🚀 快速開始

### 使用方式
直接用瀏覽器開啟資料夾中的 `index.html` 即可使用。

### 檔案結構說明
本工具已重構為現代化網頁結構：

```
├── index.html       # 主程式入口 (請開啟此檔案)
├── style.css        # 介面樣式表
├── parser.js        # 核心解析邏輯 (CSV/HTML 處理)
├── app.js           # 應用程式控制邏輯 (UI 互動)
└── README.md        # 本說明文件
```

## 📊 支援的表單類型

| 類型 | 範例 |
|------|------|
| 總評量表 | 成績總評表、學期測驗及實務操作評核成績紀錄表 |
| 單站評量 | DOPS、mini-CEX、CbD |
| EPA | EPA 評量表 (含 OPA 分數) |
| Milestone | 里程碑評量 (含 12 項核心能力 Level) |
| 基礎課程 | 臨床實習項目及實習成效評量 (含通過狀態) |
| 學員回饋 | 實習生總回饋、整體實習成效回饋 |

## 📁 匯出格式

CSV 匯出包含以下欄位：

| 欄位 | 說明 |
|------|------|
| 執行日期 | 評量日期 |
| 學員姓名 | 學員姓名 |
| 教師/主持人| 評量教師 |
| 類型 | 評量類型 |
| 科別 | 訓練科別 |
| 表單標題 | 完整表單名稱 |
| 總分 | 分數 (基礎課程顯示通過數，EPA 留空) |
| OPA1-3 | EPA 專用 OPA 分數 |
| 儀器別 | 自動偵測之儀器類型 |
| 各站成績 | 分項成績詳情 |
| 里程碑指標 (12欄) | 一～五大核心能力各子項 Level (1-5) |
| 表現良好 | 教師回饋優點 |
| 建議加強 | 教師建議改進 |
| 學員回饋 | 學員心得與期許 |

## 🛠️ 技術架構

- **前端**: 純 HTML5 + Vanilla ES6 JavaScript
- **樣式**: TailwindCSS (CDN) + Custom CSS (`style.css`)
- **圖表**: Chart.js (CDN)
- **無後端依賴** - 所有處理皆在瀏覽器本地完成，保障資料隱私

## 🔒 隱私說明

所有資料處理皆在本地瀏覽器完成，**不會上傳任何資料至伺服器**。

## 📝 授權

MIT License

---

**輔大醫院 影像醫學科** | Made with ❤️ for UGY Training
